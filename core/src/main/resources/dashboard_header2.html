<script type="text/javascript">  	
		function afterLoading(current, previous) {
			$("iframe.fancybox-iframe").contents().find("#side-panel").hide();
			$("iframe.fancybox-iframe").contents().find("#header").hide();
			$("iframe.fancybox-iframe").contents().find("#footer").hide();		
		}
		
		function afterShowing() {
			$("iframe.fancybox-iframe").contents().find("#map").find("area").bind("click", doInterceptClickArea);			
			$("iframe.fancybox-iframe").contents().find("a").bind("click", doInterceptClickA);			
		}
		
		var doInterceptClickA = function (e) {
			e.target.setAttribute("target", "_blank");
		}

		var doInterceptClickArea = function (e) {
			console.log("clicked an area");
			e.preventDefault();
			var link = $(this).attr("href");
			$.fancybox.open({
				href: link,
				type: 'iframe',
				fitToView: false,
				autoSize: false,
				autoDimensions: false,
				width: 850,
				height: 600,
				afterLoad: function(current, previous) {					
					afterLoading (current, previous);
				},
				afterShow: function() {					
					afterShowing();
				},
			});						
		}
				
        $(document).ready(function(){
            $("#results tr.results").addClass("odd");
            $("#results tr.detailedresults").hide();
            $("#results tr.results:first-child").show();     
			$('.fancybox').fancybox({
				fitToView: false,
				autoSize: false,
				autoDimensions: false,
				width: 850,
				height: 600,
				afterLoad: function(current, previous) {					
					afterLoading(current, previous);			
				},
				afterShow: function() {				
					afterShowing();
				},	
			});
			
            $("#results tr.results > td:not(.feature)").click(function(){
				$("#results tr.detailedresults").hide();
                $(this).parent().next("tr").toggle();
            });
	     });
    </script>
	</head>
	